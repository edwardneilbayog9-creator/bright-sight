

# Plan: Professional PDF-Style Clinical Report

## Overview

Replace the current `window.print()` approach with a dedicated report generation system that opens a clean, professionally formatted clinical report in a new window, specifically designed for printing. This ensures no toast notifications, no sidebar, no interactive UI elements -- just a clean medical document.

## Approach

Create a new `ReportGenerator` utility component that builds a standalone HTML document in a new browser window, formatted as a proper clinical report with:
- Clinic letterhead / header
- Structured patient and analysis sections with clean table layouts
- Professional typography and spacing
- Footer with disclaimers and page info
- No React UI artifacts, toasts, or interactive elements

## Files to Create

### 1. `src/utils/generateReport.ts` (New File)

A utility function that takes a `Detection` object and opens a new window with a fully self-contained HTML document styled for printing. Key sections:

- **Report Header**: Clinic name ("BrightSight Eye Clinic"), report title, report ID, and generation date
- **Patient Information Table**: Name, age, date of analysis, status -- in a bordered table format
- **Fundus Image**: Centered with a caption, properly sized for print
- **Classification Result**: Disease name, confidence percentage, displayed in a highlighted box
- **Preliminary Findings**: Table with finding name, detected status, and confidence level
- **Review Urgency**: Clearly marked recommendation section
- **Doctor's Review** (if available): Reviewer name, severity, diagnosis, recommendations, follow-up date
- **Medical Disclaimer**: Standard disclaimer text
- **Footer**: "This report was generated by BrightSight Pre-Diagnosis System" with timestamp

The HTML will use inline styles only (no Tailwind) to ensure consistent rendering in the print window. It will auto-trigger `window.print()` after loading.

### 2. `src/pages/DetectionDetail.tsx` (Modify)

- Import the new `generateReport` utility
- Update `handlePrint` to call `generateReport(detection)` instead of `window.print()`
- No other changes needed

## What the Report Will Look Like

```text
+--------------------------------------------------+
|  BRIGHTSIGHT EYE CLINIC                           |
|  Pre-Diagnosis Report                             |
|  Report ID: DET-xxxxx    Date: Feb 14, 2026       |
+--------------------------------------------------+
|                                                    |
|  PATIENT INFORMATION                               |
|  +----------------------------------------------+ |
|  | Name:    John Doe                             | |
|  | Age:     45 years                             | |
|  | Date:    Feb 14, 2026, 2:30 PM               | |
|  | Status:  Analyzed                             | |
|  +----------------------------------------------+ |
|                                                    |
|  FUNDUS IMAGE                                      |
|  [          centered image here          ]         |
|                                                    |
|  CLASSIFICATION RESULT                             |
|  +----------------------------------------------+ |
|  | Classification: Diabetic Retinopathy          | |
|  | Confidence:     92.3%                         | |
|  +----------------------------------------------+ |
|                                                    |
|  PRELIMINARY FINDINGS                              |
|  +------+-----------------------------+----------+ |
|  | #    | Finding                     | Status   | |
|  +------+-----------------------------+----------+ |
|  | 1    | Possible hemorrhages        | Detected | |
|  | 2    | Microaneurysms present      | Detected | |
|  +------+-----------------------------+----------+ |
|                                                    |
|  REVIEW RECOMMENDATION: Urgent                     |
|  Schedule immediate consultation...                |
|                                                    |
|  DOCTOR'S REVIEW (if available)                    |
|  Reviewed by: Dr. Smith | Severity: Moderate       |
|  Diagnosis: ...                                    |
|  Recommendations: ...                              |
|                                                    |
|  ------------------------------------------------  |
|  DISCLAIMER: This is a pre-diagnosis tool...       |
|  Generated by BrightSight Pre-Diagnosis System     |
+--------------------------------------------------+
```

## Technical Details

- The report is a self-contained HTML string with inline CSS -- no external dependencies
- Opens in a new window via `window.open()`, writes HTML via `document.write()`
- Automatically calls `window.print()` after the content loads
- Uses `@media print` styles within the document for optimal print output
- Colors are kept minimal (black, gray, accent borders) for professional B&W printing
- The fundus image is embedded as base64 so it prints without network requests
- No toasts or notifications can appear since it is a completely separate window

## What Stays the Same

- The on-screen Detection Detail page layout is unchanged
- The "Print Report" button remains in the same location
- All other pages and components are unaffected

